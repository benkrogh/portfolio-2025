---
import Layout from "./Layout.astro";
import CustomCursor from "@/components/CustomCursor";
import Footer from "@/components/Footer.astro";
import { TEXT_COLOR } from "@/utils/colorUtils";
import type { CollectionEntry } from 'astro:content';

// Import fonts directly in this component
import '../styles/fonts.css';

interface Props {
  post: CollectionEntry<'blog'>;
  Content: any;
}

const { post, Content } = Astro.props;

// No redirect logic here - layouts can't modify responses
---

<Layout title={post?.data?.title || 'Blog Post'}>
  <!-- Direct font styles in the head -->
  <style slot="head">
    /* Critical fonts for blog content */
    @font-face {
      font-family: 'Geist Mono';
      src: url('/fonts/GeistMono-Regular.woff2') format('woff2');
      font-weight: 400;
      font-style: normal;
      font-display: block;
    }
    
    .blog-content * {
      font-family: 'Geist Mono', monospace !important;
    }
  </style>
  
  <div class="custom-cursor-area">
    <CustomCursor client:only="react" />
    <main class="w-full max-w-[1500px] mx-auto px-4 blog-main font-[Geist Mono]">
      {post?.data && (
        <div
          class="rounded-[32px] h-72 p-8 sm:p-12 pb-12 w-full flex flex-col justify-end"
          style={{
            backgroundColor: post.data.color,
            color: TEXT_COLOR
          }}
        >
          <h1 class="font-['Geist_Mono'] font-light text-[2.5rem] mb-2">
            {post.data.title}
          </h1>
          <div class="font-['Geist_Mono'] font-light text-2xl opacity-50">
            <span>{post.data.date}</span>
          </div>
        </div>
      )}
      <div class="prose space-y-2 mx-auto max-w-[660px] mb-4 mt-8 blog-content"
           style="font-family: 'Geist Mono', monospace !important;">
        <article style="font-family: 'Geist Mono', monospace !important;">
          {Content && <Content />}
        </article>
      </div>
    </main>
    <Footer />
  </div>
</Layout>

<style is:global>
  /* Apply to all nested elements in the blog content with maximum specificity */
  body .blog-content *,
  body .blog-content p,
  body .blog-content h1,
  body .blog-content h2,
  body .blog-content h3,
  body .blog-content h4,
  body .blog-content h5,
  body .blog-content h6,
  body .blog-content ul,
  body .blog-content ol,
  body .blog-content li,
  body .blog-content a,
  body .blog-content blockquote,
  body .blog-content strong,
  body .blog-content em {
    font-family: 'Geist Mono', monospace !important;
  }
  
  /* Direct styling for intro paragraphs */
  body .blog-content .intro-paragraph {
    font-size: 1.5rem !important;
    line-height: 1.5 !important;
    color: #333 !important;
    font-weight: 400 !important;
    letter-spacing: -0.01em !important;
    margin-bottom: 1.5rem !important;
  }
  
  /* Styling for intro paragraphs as blockquotes - with more aggressive overrides */
  body .blog-content blockquote {
    font-size: 1.5rem !important;
    line-height: 1.5 !important;
    color: #333 !important;
    font-weight: 400 !important;
    letter-spacing: -0.01em !important;
    border-left: none !important; /* Remove default blockquote styling */
    padding-left: 0 !important;   /* Remove default padding */
    margin-left: 0 !important;    /* Remove default margin */
    font-style: normal !important; /* Remove italic styling if present */
    margin-bottom: 1.5rem !important; /* Add some bottom margin */
    quotes: none !important; /* Prevent quotes */
  }
  
  /* Additional overrides to prevent quotes */
  body .blog-content blockquote::before,
  body .blog-content blockquote::after {
    content: '' !important;
    display: none !important;
  }
  
  body .blog-content blockquote p::before,
  body .blog-content blockquote p::after {
    content: '' !important;
    display: none !important;
  }
  
  /* Make H3 headings bolder */
  body .blog-content h3 {
    font-size: 1.375rem !important;
    line-height: 1.4 !important;
    font-weight: 500 !important; /* Make H3 bolder */
    color: #17120A !important;
    letter-spacing: -0.02em !important;
  }
</style>

<script>
  // Force apply Geist Mono to all elements in the blog content
  document.addEventListener('DOMContentLoaded', () => {
    // Create a style element to force the font
    const style = document.createElement('style');
    style.textContent = `
      @font-face {
        font-family: 'Geist Mono';
        src: url('/fonts/GeistMono-Regular.woff2') format('woff2');
        font-weight: 400;
        font-style: normal;
        font-display: block;
      }
      
      .blog-content * {
        font-family: 'Geist Mono', monospace !important;
      }
    `;
    document.head.appendChild(style);
    
    // Apply to all content elements
    const elements = document.querySelectorAll('.blog-content *');
    elements.forEach(el => {
      if (el instanceof HTMLElement) {
        el.style.fontFamily = "'Geist Mono', monospace";
      }
    });
  });
</script>
